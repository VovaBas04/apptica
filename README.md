<h1>Техническое задание</h1>
<p>В репозитории представлен Makefile, у которого есть следующие комманды </p>
<ul>
    <li>up - создать приложение и запустить его на порту 8080</li>
    <li>seed -  единовременно вызывает комманду, которая заполняет базу данных с эндпоинта apptica</li>
    <li>run-dev - комманда рассписания, которая каждый день в полночь запускает комманду(необязательна к выполнению)</li>
</ul>
<p> Для реализации текущей задачи был использован пакет Laravel Sail, для упрощение разворачивания приложения, поэтому всевозможные комманды нужно запускать через sail artisan</p>
<h2>Комментарии к реализации поставленной задачи</h2>
<p> Задача заполнения данных была разбита, вызов происходит через комманду(Job), логика разбита в следующие сервисы</p>
<ul>
    <li>PrepareDataService -  класс, который получает данные с эндпоинта, и конвертирует данные для удобного сохранения в бд</li>
    <li>SaveRatingService - класс для сохранения одного рейтинга в базу данных</li>
</ul>
<p>Также использован Action класс для сохранения всех категорий и их рейтингов в бд</p>
<p>Для реализации задачи написания эндпоинта был создан контроллер  одиночного действия DecideController, который содержит в себе</p>
<ul>
    <li>DecideRequest -  класс, реквеста с валидацией и проверкой наличия даты в запросе. В случае ошибочных данных вернется 400 ошибка.</li>
    <li>GetRatingService - класс, который достает из бд данные и преобразует их к удобному для вывода виду</li>
    <li>RatingResourceCollection - класс, который обеспечивает вывод из контроллера</li>
</ul>
<p>Также были реализованы дополнительные задачи с помощью посредников(middleware)</p>
<ul>
    <li>LoggerVisit - класс посредника, который осуществляет логгирования зашедшего на эндпоинт пользователя. Информация записывается по пути /storage/endpoint.log</li>
    <li>RateLimit - посредник, обеспечивающий не более 5 заходов в минуту пользователю, иначе выдается стандартная ошибка 429(Too many request)</li>
</ul>
<h6>P.S.</h6> Предполагается, что если данных нету, то будет возвращено пустое тело ответа с статусом 200. Также стоит отметить, что данные, которые нужно писать в запрос на apptica, распологаются в файле App\Providers\AppServiceProvider, которые разрешают зависимость у класса. Там находится applicationId,countryId,date_from,date_to(date_to представляет собой сегодняшний день, т.е Carbon::today). В случае изменения начального дня, или id приложения - их можно переопределить в одном файле.
